var Entity,auth,_;_=require("underscore"),auth=require("./../lib/auth"),Entity=require("./../models/entity"),module.exports=function(a){var b,c;return b={},c=a.locals.mongoose,b.create=function(a,b){return auth.authenticateRequest(a,b,function(c){var d,e;return e=a.body.entityId,e?(d=_.find(c.bookmarks,function(a){return a.entityId===e}),d?b.status(200).send():(c.bookmarks.push({entityId:e}),c.save(function(a){return a?b.status(422).send(a):b.status(201).send()}))):b.status(422).send({errors:{entityId:"is required"}})})},b.destroy=function(a,b){return auth.authenticateRequest(a,b,function(c){var d;return d=a.body.entityId,d?(c.bookmarks=_.reject(c.bookmarks,function(a){return a.entityId===d}),c.save(function(a){return a?b.status(422).send(a):b.status(200).send()})):b.status(422).send({errors:{entityId:"is required"}})})},b};
var User,auth;auth=require("./../lib/auth.js"),User=require("./../models/user.js"),module.exports=function(a){var b,c;return b={},c=a.locals.mongoose,b.create=function(a,b){var c,d;return a.body.email&&(c=a.body.email.toLowerCase()),d=a.body.password,User.findOne({email:c}).exec(function(a,c){return a?b.status(500).send(a):c?d&&c.verifyPassword(d)?(c.setAuthenticationToken(),c.save(function(a){return a?b.status(500).send(a):b.status(201).send(c)})):b.status(401).send({errors:{password:{message:"is incorrect."}}}):b.status(401).send({errors:{email:{message:"does not exist."}}})})},b.destroy=function(a,b){return auth.authenticateRequest(a,b,function(a){return a.unsetAuthenticationToken(),a.save(function(a){return a?b.status(500).send(a):b.status(200).send()})})},b.verify=function(a,b){return auth.authenticateRequest(a,b,function(){return b.status(200).send()})},b};